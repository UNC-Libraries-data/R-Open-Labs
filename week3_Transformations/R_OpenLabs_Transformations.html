<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>beginR: Data Transformations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="R_OpenLabs_Transformations_files/libs/clipboard/clipboard.min.js"></script>
<script src="R_OpenLabs_Transformations_files/libs/quarto-html/quarto.js"></script>
<script src="R_OpenLabs_Transformations_files/libs/quarto-html/popper.min.js"></script>
<script src="R_OpenLabs_Transformations_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="R_OpenLabs_Transformations_files/libs/quarto-html/anchor.min.js"></script>
<link href="R_OpenLabs_Transformations_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="R_OpenLabs_Transformations_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="R_OpenLabs_Transformations_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="R_OpenLabs_Transformations_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="R_OpenLabs_Transformations_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-and-other-downloads" id="toc-data-and-other-downloads" class="nav-link active" data-scroll-target="#data-and-other-downloads">Data and other downloads</a></li>
  <li><a href="#today" id="toc-today" class="nav-link" data-scroll-target="#today">Today</a>
  <ul class="collapse">
  <li><a href="#start-a-new-project-in-r" id="toc-start-a-new-project-in-r" class="nav-link" data-scroll-target="#start-a-new-project-in-r">Start a New Project in R</a></li>
  <li><a href="#loading-the-tidyverse" id="toc-loading-the-tidyverse" class="nav-link" data-scroll-target="#loading-the-tidyverse">Loading the tidyverse</a></li>
  <li><a href="#importing-data" id="toc-importing-data" class="nav-link" data-scroll-target="#importing-data">Importing Data</a></li>
  <li><a href="#filtering" id="toc-filtering" class="nav-link" data-scroll-target="#filtering">Filtering</a></li>
  <li><a href="#relational-and-assignment-operators" id="toc-relational-and-assignment-operators" class="nav-link" data-scroll-target="#relational-and-assignment-operators">Relational and Assignment Operators</a></li>
  <li><a href="#reordering-data-arrange" id="toc-reordering-data-arrange" class="nav-link" data-scroll-target="#reordering-data-arrange">Reordering Data (arrange)</a></li>
  <li><a href="#selecting-data-select" id="toc-selecting-data-select" class="nav-link" data-scroll-target="#selecting-data-select">Selecting Data (select)</a></li>
  <li><a href="#renaming-columns" id="toc-renaming-columns" class="nav-link" data-scroll-target="#renaming-columns">Renaming Columns</a></li>
  <li><a href="#adding-new-variables" id="toc-adding-new-variables" class="nav-link" data-scroll-target="#adding-new-variables">Adding New Variables</a></li>
  <li><a href="#summarising-data" id="toc-summarising-data" class="nav-link" data-scroll-target="#summarising-data">Summarising Data</a></li>
  <li><a href="#piping" id="toc-piping" class="nav-link" data-scroll-target="#piping">Piping</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">beginR: Data Transformations</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="data-and-other-downloads" class="level3">
<h3 class="anchored" data-anchor-id="data-and-other-downloads">Data and other downloads</h3>
<p><a href="data/5k_wine_reviews.csv">Five Thousand Wine Reviews</a></p>
</section>
<section id="today" class="level2">
<h2 class="anchored" data-anchor-id="today">Today</h2>
<p>This workshop aims to cover:</p>
<ul>
<li>Review of Previous Topics
<ul>
<li>Starting a New Project</li>
<li>Loading the tidyverse</li>
<li>Importing Data</li>
</ul></li>
<li>Data Transformations
<ul>
<li>Filtering Data</li>
<li>Relational and Assignment Operators</li>
<li>Reordering Data (arrange)</li>
<li>Selecting Data</li>
<li>Renaming Columns</li>
<li>Adding new Variables (mutate)</li>
<li>Summerising Data</li>
</ul></li>
<li><a href="http://r4ds.had.co.nz/transform.html">R for Data Science Chapter 5</a></li>
</ul>
<section id="start-a-new-project-in-r" class="level3">
<h3 class="anchored" data-anchor-id="start-a-new-project-in-r">Start a New Project in R</h3>
<p>It is best practice to set up a new directory each time we start a new project in R. To do so, complete the following steps:</p>
<ol type="1">
<li>Go to <strong>File &gt; New Project &gt; New Directory &gt; New Project</strong>.</li>
<li>Type in a name for your directory and click <strong>Browse</strong>. Be sure to pick a place for your directory that you will be able to <strong>find later</strong>.</li>
<li>Go to <strong>Finder</strong> on Mac or <strong>File Explorer</strong> on PC and find the directory you just created.</li>
<li>Inside your project directory, create a new folder called <strong>data</strong>.</li>
<li>Download or copy the <strong>data file</strong> (5k_wine_reviews.csv) into the data folder.</li>
<li>Go to <strong>File &gt; Save As</strong> to give your R script a name and save it in your project directory.</li>
</ol>
</section>
<section id="loading-the-tidyverse" class="level3">
<h3 class="anchored" data-anchor-id="loading-the-tidyverse">Loading the tidyverse</h3>
<p>The first few lines of our R script are made up of comments to document the script’s purpose, creator and date. Next, we use the <code>library()</code> function to load any packages that our script will need to run. In this workshop, we are using the <strong>tidyverse</strong> package for all of our projects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Purpose: Transforming Wine Review Data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Author: Nuvan Rathnayaka</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Date: January 2019</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup -----------------------------------------------------------</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-data">Importing Data</h3>
<p>We use the <code>read_csv()</code> function to import our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Import ------------------------------------------------------</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>reviews <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/5k_wine_reviews.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When we use <code>read_csv()</code>, our data is stored as a type of object in R called a <strong>data frame</strong>. One of the nice things about data frames is that we can see a visual representation of them using R Studio. Take a look at your <strong>Environment tab</strong> in the upper right and click on the <strong>reviews</strong> object you just created.</p>
<p><img src="figures/environment.png" class="img-fluid" width="800"></p>
<p>The data will be represented as a table in a new tab.</p>
<p><img src="figures/visual.png" class="img-fluid"></p>
</section>
<section id="filtering" class="level3">
<h3 class="anchored" data-anchor-id="filtering">Filtering</h3>
<p>We have a fairly big data set. What if we want to focus on certain records? For example, let’s say I’m only interested in Chilean wine. I can use the <code>filter()</code> function to only look at wines with “Chile” as their country of origin.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(reviews, country <span class="sc">==</span> <span class="st">"Chile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 194 × 10
   country description desig…¹ points price provi…² regio…³ title variety winery
   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
 1 Chile   White flow… Estate      86    15 Colcha… &lt;NA&gt;    Esta… Viogni… Estam…
 2 Chile   A berry ar… &lt;NA&gt;        86     9 Maule … &lt;NA&gt;    Sund… Merlot  Sunda…
 3 Chile   This is mu… Gran R…     85    22 Colcha… &lt;NA&gt;    Casa… Petit … Casa …
 4 Chile   Lightly he… Reserve     85    13 Maipo … &lt;NA&gt;    Tres… Pinot … Tres …
 5 Chile   Caramelize… Specia…     86    12 Rapel … &lt;NA&gt;    Ares… Carmen… Aresti
 6 Chile   A bright n… Single…     87    18 Leyda … &lt;NA&gt;    Leyd… Chardo… Leyda 
 7 Chile   This blend… Condes…     91    29 Aconca… &lt;NA&gt;    Cond… Red Bl… Conde…
 8 Chile   Dry, briar… 20 Bar…     91    32 Maipo … &lt;NA&gt;    Cono… Cabern… Cono …
 9 Chile   Dry, spicy… The 7t…     91    20 Loncom… &lt;NA&gt;    G7 2… Cabern… G7    
10 Chile   Haven't se… Unusua…     88    50 Maipo … &lt;NA&gt;    Terr… Red Bl… Terra…
# … with 184 more rows, and abbreviated variable names ¹​designation, ²​province,
#   ³​region_1
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>When we use the <code>filter</code> function on our reviews object, it desplays the results in our <strong>Console</strong> tab. However, these results have not been saved, only displayed. If we want to save our results so we can perform additional transformations on them later, we need to <strong>assign</strong> them to a new data frame. Here, we’ll name the data frame “chilean”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>chilean <span class="ot">&lt;-</span> <span class="fu">filter</span>(reviews, country <span class="sc">==</span> <span class="st">"Chile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s say I also don’t have a lot of money to spend on wine, so I need to limit my data set to wines that cost $20 or less. We should edit our filter to include a condition on price.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>chilean <span class="ot">&lt;-</span> <span class="fu">filter</span>(reviews, country <span class="sc">==</span> <span class="st">"Chile"</span>, price <span class="sc">&lt;=</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that this time we are assigining the results to the <strong>same</strong> object we used before. This allows us to replace our previous data for that object with new data. Now, if we click on the “chilean” data frame in our Environment tab, we can see our data set has been limited only to wines from Chile that are $20 or less.</p>
</section>
<section id="relational-and-assignment-operators" class="level3">
<h3 class="anchored" data-anchor-id="relational-and-assignment-operators">Relational and Assignment Operators</h3>
<p>Our filter uses some symbols you may not be familiar with, such as <code>==</code> and <code>&lt;=</code>. These are called <strong>relational operators</strong>. We use a relational operator to <strong>check</strong> the relationship between the two <strong>operands</strong> on either side of it.</p>
<table class="table">
<colgroup>
<col style="width: 22%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Operator</th>
<th>Relationship Check</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>&gt;</code></td>
<td>Is the left operand <strong>greater than</strong> the right operand?</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>&lt;</code></td>
<td>Is the left operand <strong>less than</strong> the right operand?</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>&gt;=</code></td>
<td>Is the left operand <strong>greater than or equal to</strong> the right operand?</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>&lt;=</code></td>
<td>Is the left operand <strong>less than or equal to</strong> the right operand?</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>==</code></td>
<td>Is the left operand <strong>equal</strong> to the right operand?</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>!=</code></td>
<td>Is the left operand <strong>not equal</strong> to the right operand?</td>
</tr>
</tbody>
</table>
<p>Above, you’ll notice that we use <code>==</code> to <strong>check</strong> if something is equal. This is different from <strong>defining</strong> something as equal. To <strong>set or assign</strong> a value, we use either <code>=</code> or <code>&lt;-</code> instead of <code>==</code>. For example:</p>
<table class="table">
<colgroup>
<col style="width: 37%">
<col style="width: 62%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Use</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>filter(reviews, country == "Chile")</code></td>
<td><strong>Check</strong> each review to see if the country is equal to “Chile”</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>age = 52</code></td>
<td><strong>Assign</strong> the value 52 to a variable called “age”</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>data &lt;- survey_results</code></td>
<td><strong>Assign</strong> the contents of the object called “survey_results” to an object called “data”.</td>
</tr>
</tbody>
</table>
</section>
<section id="reordering-data-arrange" class="level3">
<h3 class="anchored" data-anchor-id="reordering-data-arrange">Reordering Data (arrange)</h3>
<p>Let’s arrange the rows of our data frame in a way that’s more informative. This time, we’ll just take a look at the results in our console rather than assigning them to an object.</p>
<p>First, I want to know which wines in my Chilean data set get the highest number of review points. The <code>arrange()</code> function allows us to reorder our data by a particular variable. Below, we’ll reorder by points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(chilean, points)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 154 × 10
   country description desig…¹ points price provi…² regio…³ title variety winery
   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
 1 Chile   Aromas of … Gran R…     80    19 Leyda … &lt;NA&gt;    Viña… Chardo… Viña …
 2 Chile   Fluffy, sw… Reserve     80    15 Maule … &lt;NA&gt;    Cuev… Chardo… Cueva…
 3 Chile   Jumpy on t… Grand …     81    20 Rapel … &lt;NA&gt;    Pura… Pinot … Pura 8
 4 Chile   Crisp but … &lt;NA&gt;        81    14 Maipo … &lt;NA&gt;    Cous… Sauvig… Cousi…
 5 Chile   Flat aroma… Reserv…     81    12 Maule … &lt;NA&gt;    Ovej… Rosé    Oveja…
 6 Chile   Funky and … &lt;NA&gt;        81    10 Centra… &lt;NA&gt;    Arau… Carmen… Arauco
 7 Chile   Rubbery, m… &lt;NA&gt;        81    10 Cachap… &lt;NA&gt;    Corn… Cabern… Corne…
 8 Chile   This is ed… Albamar     81    13 Casabl… &lt;NA&gt;    Will… Pinot … Willi…
 9 Chile   Smells veg… Selecc…     82    15 Maipo … &lt;NA&gt;    Viña… Sauvig… Viña …
10 Chile   Smells per… Hacien…     82    13 Centra… &lt;NA&gt;    Fran… Pinot … Franç…
# … with 144 more rows, and abbreviated variable names ¹​designation, ²​province,
#   ³​region_1
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>Well, that sort of worked. My wines are reordered by points, but in ascending order. To reorder them in descending order, we need to use another function inside the arrange function. As you learned last week, this is called a nested function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(chilean, <span class="fu">desc</span>(points))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 154 × 10
   country description desig…¹ points price provi…² regio…³ title variety winery
   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
 1 Chile   Dry, spicy… The 7t…     91    20 Loncom… &lt;NA&gt;    G7 2… Cabern… G7    
 2 Chile   Composed b… Gran R…     90    15 Colcha… &lt;NA&gt;    Carm… Carmen… Carmen
 3 Chile   Over the p… 1865 S…     90    19 Leyda … &lt;NA&gt;    San … Sauvig… San P…
 4 Chile   Toasty and… Gran R…     89    18 Maipo … &lt;NA&gt;    Tara… Carmen… Tarap…
 5 Chile   This dry-f… Maripo…     89    20 Loncom… &lt;NA&gt;    Gill… Syrah-… Gillm…
 6 Chile   Composed a… Envero…     88    15 Colcha… &lt;NA&gt;    Apal… Carmen… Apalt…
 7 Chile   Bisquertt … Casa L…     88    11 Colcha… &lt;NA&gt;    Viña… Merlot  Viña …
 8 Chile   Aromas of … Reserv…     88    10 Maipo … &lt;NA&gt;    De M… Carmen… De Ma…
 9 Chile   At first t… Estate…     88    12 Rapel … &lt;NA&gt;    Lapo… Merlot  Lapos…
10 Chile   With its h… Estate…     88    15 Maipo … &lt;NA&gt;    Carm… Cabern… Carmen
# … with 144 more rows, and abbreviated variable names ¹​designation, ²​province,
#   ³​region_1
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>Now we can see which wines have the highest number of points. But what if we want to reorder by <strong>multiple</strong> variables? For example, many wines with the same number of points have different prices. What if we wanted to reorder those wines by price as well, so we can see which wines have the highest reviews with the lowest prices? The <code>arrange()</code> function allows us to add multiple variables simply by using commas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(chilean, <span class="fu">desc</span>(points), price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 154 × 10
   country description desig…¹ points price provi…² regio…³ title variety winery
   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
 1 Chile   Dry, spicy… The 7t…     91    20 Loncom… &lt;NA&gt;    G7 2… Cabern… G7    
 2 Chile   Composed b… Gran R…     90    15 Colcha… &lt;NA&gt;    Carm… Carmen… Carmen
 3 Chile   Over the p… 1865 S…     90    19 Leyda … &lt;NA&gt;    San … Sauvig… San P…
 4 Chile   Toasty and… Gran R…     89    18 Maipo … &lt;NA&gt;    Tara… Carmen… Tarap…
 5 Chile   This dry-f… Maripo…     89    20 Loncom… &lt;NA&gt;    Gill… Syrah-… Gillm…
 6 Chile   Aromas of … Reserv…     88    10 Maipo … &lt;NA&gt;    De M… Carmen… De Ma…
 7 Chile   Dark berry… &lt;NA&gt;        88    10 Centra… &lt;NA&gt;    Másc… Cabern… Másca…
 8 Chile   Bisquertt … Casa L…     88    11 Colcha… &lt;NA&gt;    Viña… Merlot  Viña …
 9 Chile   At first t… Estate…     88    12 Rapel … &lt;NA&gt;    Lapo… Merlot  Lapos…
10 Chile   Right off … Reserve     88    12 Maipo … &lt;NA&gt;    Casa… Cabern… Casa …
# … with 144 more rows, and abbreviated variable names ¹​designation, ²​province,
#   ³​region_1
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
</section>
<section id="selecting-data-select" class="level3">
<h3 class="anchored" data-anchor-id="selecting-data-select">Selecting Data (select)</h3>
<p>Most real world data sets we want to use in our research are going to be messy, and we’ll need to go through a process of cleaning the data before we can start to explore and analyze it. The first steps in many data cleaning processes involve removing data that we don’t need.</p>
<p>Going back to our original reviews data frame, let’s imagine we are only interested in the country, province and variety of our wines. We could create a new object called “wine_types” using the <code>select()</code> function. We’ll also <strong>preview</strong> our new object by simply typing its name and running the script.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>wine_types <span class="ot">&lt;-</span> <span class="fu">select</span>(reviews, country, province, variety)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>wine_types</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,000 × 3
   country  province          variety           
   &lt;chr&gt;    &lt;chr&gt;             &lt;chr&gt;             
 1 Italy    Sicily &amp; Sardinia White Blend       
 2 Portugal Douro             Portuguese Red    
 3 US       Oregon            Pinot Gris        
 4 US       Michigan          Riesling          
 5 US       Oregon            Pinot Noir        
 6 Spain    Northern Spain    Tempranillo-Merlot
 7 Italy    Sicily &amp; Sardinia Frappato          
 8 France   Alsace            Gewürztraminer    
 9 Germany  Rheinhessen       Gewürztraminer    
10 France   Alsace            Pinot Gris        
# … with 4,990 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>But what if we have a lot of columns in our dataset and only need to remove one or two? Look at our chilean data frame again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>chilean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 154 × 10
   country description desig…¹ points price provi…² regio…³ title variety winery
   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
 1 Chile   White flow… Estate      86    15 Colcha… &lt;NA&gt;    Esta… Viogni… Estam…
 2 Chile   A berry ar… &lt;NA&gt;        86     9 Maule … &lt;NA&gt;    Sund… Merlot  Sunda…
 3 Chile   Lightly he… Reserve     85    13 Maipo … &lt;NA&gt;    Tres… Pinot … Tres …
 4 Chile   Caramelize… Specia…     86    12 Rapel … &lt;NA&gt;    Ares… Carmen… Aresti
 5 Chile   A bright n… Single…     87    18 Leyda … &lt;NA&gt;    Leyd… Chardo… Leyda 
 6 Chile   Dry, spicy… The 7t…     91    20 Loncom… &lt;NA&gt;    G7 2… Cabern… G7    
 7 Chile   Composed a… Envero…     88    15 Colcha… &lt;NA&gt;    Apal… Carmen… Apalt…
 8 Chile   Bisquertt … Casa L…     88    11 Colcha… &lt;NA&gt;    Viña… Merlot  Viña …
 9 Chile   Clean and … Natura      87    11 Casabl… &lt;NA&gt;    Emil… Chardo… Emili…
10 Chile   Rooty and … Grey […     87    20 Maipo … &lt;NA&gt;    Vent… Cabern… Venti…
# … with 144 more rows, and abbreviated variable names ¹​designation, ²​province,
#   ³​region_1
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>You’ll notice it has two columns which are no longer useful for us. The “country” column is the same for every row, and the “region_1” column is missing data in every row. Let’s remove those columns using <code>select()</code>. This time, we’ll use another nested function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>chilean <span class="ot">&lt;-</span> <span class="fu">select</span>(chilean, <span class="sc">-</span><span class="fu">c</span>(country, region_1))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>chilean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 154 × 8
   description                 desig…¹ points price provi…² title variety winery
   &lt;chr&gt;                       &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
 1 White flower, lychee and a… Estate      86    15 Colcha… Esta… Viogni… Estam…
 2 A berry aroma comes with c… &lt;NA&gt;        86     9 Maule … Sund… Merlot  Sunda…
 3 Lightly herbal strawberry … Reserve     85    13 Maipo … Tres… Pinot … Tres …
 4 Caramelized oak and vanill… Specia…     86    12 Rapel … Ares… Carmen… Aresti
 5 A bright nose with green a… Single…     87    18 Leyda … Leyd… Chardo… Leyda 
 6 Dry, spicy aromas of tobac… The 7t…     91    20 Loncom… G7 2… Cabern… G7    
 7 Composed and structured, w… Envero…     88    15 Colcha… Apal… Carmen… Apalt…
 8 Bisquertt usually does wel… Casa L…     88    11 Colcha… Viña… Merlot  Viña …
 9 Clean and honest up front,… Natura      87    11 Casabl… Emil… Chardo… Emili…
10 Rooty and leafy on the nos… Grey […     87    20 Maipo … Vent… Cabern… Venti…
# … with 144 more rows, and abbreviated variable names ¹​designation, ²​province
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>We use the c() function to combine elements and the - sign to indicate that we want those elements to be removed.</p>
<p>Sometimes, we’ll need to keep or remove a series of columns that are directly adjacent to each other in the data frame. In those circumstances, we can use the following syntax:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep columns "title" through "winery"</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(reviews, title<span class="sc">:</span>winery)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,000 × 3
   title                                                          variety winery
   &lt;chr&gt;                                                          &lt;chr&gt;   &lt;chr&gt; 
 1 Nicosia 2013 Vulkà Bianco  (Etna)                              White … Nicos…
 2 Quinta dos Avidagos 2011 Avidagos Red (Douro)                  Portug… Quint…
 3 Rainstorm 2013 Pinot Gris (Willamette Valley)                  Pinot … Rains…
 4 St. Julian 2013 Reserve Late Harvest Riesling (Lake Michigan … Riesli… St. J…
 5 Sweet Cheeks 2012 Vintner's Reserve Wild Child Block Pinot No… Pinot … Sweet…
 6 Tandem 2011 Ars In Vitro Tempranillo-Merlot (Navarra)          Tempra… Tandem
 7 Terre di Giurfo 2013 Belsito Frappato (Vittoria)               Frappa… Terre…
 8 Trimbach 2012 Gewurztraminer (Alsace)                          Gewürz… Trimb…
 9 Heinz Eifel 2013 Shine Gewürztraminer (Rheinhessen)            Gewürz… Heinz…
10 Jean-Baptiste Adam 2012 Les Natures Pinot Gris (Alsace)        Pinot … Jean-…
# … with 4,990 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove columns "title" through "winery"</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(reviews, <span class="sc">-</span><span class="fu">c</span>(title<span class="sc">:</span>winery))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,000 × 7
   country  description                     desig…¹ points price provi…² regio…³
   &lt;chr&gt;    &lt;chr&gt;                           &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
 1 Italy    Aromas include tropical fruit,… Vulkà …     87    NA Sicily… Etna   
 2 Portugal This is ripe and fruity, a win… Avidag…     87    15 Douro   &lt;NA&gt;   
 3 US       Tart and snappy, the flavors o… &lt;NA&gt;        87    14 Oregon  Willam…
 4 US       Pineapple rind, lemon pith and… Reserv…     87    13 Michig… Lake M…
 5 US       Much like the regular bottling… Vintne…     87    65 Oregon  Willam…
 6 Spain    Blackberry and raspberry aroma… Ars In…     87    15 Northe… Navarra
 7 Italy    Here's a bright, informal red … Belsito     87    16 Sicily… Vittor…
 8 France   This dry and restrained wine o… &lt;NA&gt;        87    24 Alsace  Alsace 
 9 Germany  Savory dried thyme notes accen… Shine       87    12 Rheinh… &lt;NA&gt;   
10 France   This has great depth of flavor… Les Na…     87    27 Alsace  Alsace 
# … with 4,990 more rows, and abbreviated variable names ¹​designation,
#   ²​province, ³​region_1
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>In both cases the <code>:</code> symbol means “through” and allows us to select a series of columns at once.</p>
</section>
<section id="renaming-columns" class="level3">
<h3 class="anchored" data-anchor-id="renaming-columns">Renaming Columns</h3>
<p>Renaming our columns is easy to do when we use the <code>rename</code> function. We need to provide the new name we want to use first, and then <strong>assign</strong> the old name to it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>chilean <span class="ot">&lt;-</span> <span class="fu">rename</span>(chilean, <span class="at">review_points =</span> points)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>chilean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 154 × 8
   description                desig…¹ revie…² price provi…³ title variety winery
   &lt;chr&gt;                      &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
 1 White flower, lychee and … Estate       86    15 Colcha… Esta… Viogni… Estam…
 2 A berry aroma comes with … &lt;NA&gt;         86     9 Maule … Sund… Merlot  Sunda…
 3 Lightly herbal strawberry… Reserve      85    13 Maipo … Tres… Pinot … Tres …
 4 Caramelized oak and vanil… Specia…      86    12 Rapel … Ares… Carmen… Aresti
 5 A bright nose with green … Single…      87    18 Leyda … Leyd… Chardo… Leyda 
 6 Dry, spicy aromas of toba… The 7t…      91    20 Loncom… G7 2… Cabern… G7    
 7 Composed and structured, … Envero…      88    15 Colcha… Apal… Carmen… Apalt…
 8 Bisquertt usually does we… Casa L…      88    11 Colcha… Viña… Merlot  Viña …
 9 Clean and honest up front… Natura       87    11 Casabl… Emil… Chardo… Emili…
10 Rooty and leafy on the no… Grey […      87    20 Maipo … Vent… Cabern… Venti…
# … with 144 more rows, and abbreviated variable names ¹​designation,
#   ²​review_points, ³​province
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>Above, we’ve changed the name of our “points” column to “review_points”.</p>
</section>
<section id="adding-new-variables" class="level3">
<h3 class="anchored" data-anchor-id="adding-new-variables">Adding New Variables</h3>
<p>My chilean data set has prices listed in USD, but suppose I also needed to know how many Euros each wine costs. Currently, the exchange rate is 0.85 Euros for every 1 USD. So, I just need to multiply the price column by 0.85, but how can I store the results of my currency conversion in a new column? The <code>mutate()</code> function makes that possible.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>chilean <span class="ot">&lt;-</span> <span class="fu">mutate</span>(chilean, <span class="at">EUR =</span> price <span class="sc">*</span> <span class="fl">0.85</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now I’m going to make several more changes to my data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the "price" column to "USD"</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>chilean <span class="ot">&lt;-</span> <span class="fu">rename</span>(chilean, <span class="at">USD =</span> price)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder the columns so that "USD" and "EUR" are adjacent</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>chilean <span class="ot">&lt;-</span> <span class="fu">select</span>(chilean, description<span class="sc">:</span>review_points, USD, EUR, province<span class="sc">:</span>winery)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Preview the results</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>chilean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 154 × 9
   description          desig…¹ revie…²   USD   EUR provi…³ title variety winery
   &lt;chr&gt;                &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
 1 White flower, lyche… Estate       86    15 12.8  Colcha… Esta… Viogni… Estam…
 2 A berry aroma comes… &lt;NA&gt;         86     9  7.65 Maule … Sund… Merlot  Sunda…
 3 Lightly herbal stra… Reserve      85    13 11.0  Maipo … Tres… Pinot … Tres …
 4 Caramelized oak and… Specia…      86    12 10.2  Rapel … Ares… Carmen… Aresti
 5 A bright nose with … Single…      87    18 15.3  Leyda … Leyd… Chardo… Leyda 
 6 Dry, spicy aromas o… The 7t…      91    20 17    Loncom… G7 2… Cabern… G7    
 7 Composed and struct… Envero…      88    15 12.8  Colcha… Apal… Carmen… Apalt…
 8 Bisquertt usually d… Casa L…      88    11  9.35 Colcha… Viña… Merlot  Viña …
 9 Clean and honest up… Natura       87    11  9.35 Casabl… Emil… Chardo… Emili…
10 Rooty and leafy on … Grey […      87    20 17    Maipo … Vent… Cabern… Venti…
# … with 144 more rows, and abbreviated variable names ¹​designation,
#   ²​review_points, ³​province
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>Did I mention you can use <code>select()</code> to reorder columns as well? You can!</p>
</section>
<section id="summarising-data" class="level3">
<h3 class="anchored" data-anchor-id="summarising-data">Summarising Data</h3>
<p>Now that we’ve done some cleaning of our data set, we can start to explore it a bit by taking a look at basic summary statistics with the <code>summarise()</code> function. One thing we need to remember when using <code>summarise()</code> is that missing data can cause a problem, so in many cases we will need to tell R to ignore rows with missing data using the <code>na.rm</code> parameter.</p>
<p>Let’s take a look at the mean review points for all of our Chilean wines. We’ll assign our result to a column named “mean_review_points”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(chilean, <span class="at">mean_review_points =</span> <span class="fu">mean</span>(review_points, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  mean_review_points
               &lt;dbl&gt;
1               85.9</code></pre>
</div>
</div>
<p>A more informative approach might be to look at the mean number of points by province. To do that, we first need to create a new object using the group_by() function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>by_prov <span class="ot">&lt;-</span> <span class="fu">group_by</span>(chilean, province)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(by_prov, <span class="at">mean_review_points =</span> <span class="fu">mean</span>(review_points, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 2
   province          mean_review_points
   &lt;chr&gt;                          &lt;dbl&gt;
 1 Aconcagua Costa                 88  
 2 Aconcagua Valley                86.5
 3 Cachapoal Valley                84.6
 4 Casablanca Valley               85.5
 5 Central Valley                  84.7
 6 Chile                           85  
 7 Colchagua Costa                 84  
 8 Colchagua Valley                86.6
 9 Curicó Valley                   85.8
10 Elqui Valley                    88  
11 Leyda Valley                    85.7
12 Limarí Valley                   86  
13 Loncomilla Valley               87.5
14 Lontué Valley                   87  
15 Maipo Valley                    86.3
16 Marchigue                       87  
17 Maule Valley                    85.1
18 Peumo                           87  
19 Rapel Valley                    85.7
20 Rio Claro                       86  </code></pre>
</div>
</div>
<p>Now we want to arrange the results from highest to lowest review points, but that would require us creating <strong>another</strong> object to use <code>arrange()</code> on. Instead of creating many different objects that we don’t necessarily need to keep around, let’s use pipes.</p>
</section>
<section id="piping" class="level3">
<h3 class="anchored" data-anchor-id="piping">Piping</h3>
<p>Pipes use the <code>%&gt;%</code> symbol to connect multiple functions without creating multiple objects. To use <code>group_by()</code>, <code>summarise()</code> and <code>arrange()</code> on our data all at once, we use the pipe like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chilean <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_review_points =</span> <span class="fu">mean</span>(review_points, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean_review_points))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 2
   province          mean_review_points
   &lt;chr&gt;                          &lt;dbl&gt;
 1 Aconcagua Costa                 88  
 2 Elqui Valley                    88  
 3 Loncomilla Valley               87.5
 4 Lontué Valley                   87  
 5 Marchigue                       87  
 6 Peumo                           87  
 7 Colchagua Valley                86.6
 8 Aconcagua Valley                86.5
 9 Maipo Valley                    86.3
10 Limarí Valley                   86  
11 Rio Claro                       86  
12 Curicó Valley                   85.8
13 Rapel Valley                    85.7
14 Leyda Valley                    85.7
15 Casablanca Valley               85.5
16 Maule Valley                    85.1
17 Chile                           85  
18 Central Valley                  84.7
19 Cachapoal Valley                84.6
20 Colchagua Costa                 84  </code></pre>
</div>
</div>
<p><strong>Shortcut for %&gt;%:<br>
</strong>CMD + SHIFT + m (Mac)<strong><br>
</strong>CTRL + SHIFT + m (PC)</p>
<p>Not only do the pipes prevent us from having to create lots of objects, they also allow us to arrange the code in a way that is easier to read. Notice that we also only needed to name our object once, at the beginning of the sequence, for it to be used in every function onward.</p>
<p>Let’s try another sequence of functions using the pipe to answer the following question: What is the highest price for each variety of wine in each province?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>chilean <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province, variety) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">max_price =</span> <span class="fu">max</span>(USD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(province, variety, <span class="fu">desc</span>(max_price))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'province'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 78 × 3
# Groups:   province [20]
   province          variety                   max_price
   &lt;chr&gt;             &lt;chr&gt;                         &lt;dbl&gt;
 1 Aconcagua Costa   Chardonnay                       20
 2 Aconcagua Valley  Cabernet Sauvignon               19
 3 Aconcagua Valley  Sauvignon Blanc                  19
 4 Cachapoal Valley  Cabernet Sauvignon               18
 5 Cachapoal Valley  Cabernet Sauvignon-Merlot        10
 6 Cachapoal Valley  Carmenère                        12
 7 Cachapoal Valley  Syrah                            15
 8 Casablanca Valley Chardonnay                       15
 9 Casablanca Valley Gewürztraminer                   15
10 Casablanca Valley Merlot                           17
# … with 68 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
</section>
<section id="exercises" class="level3">
<h3 class="anchored" data-anchor-id="exercises">Exercises</h3>
<p>Concerning our original “reviews” data set, use the functions we learned this week to answer the following questions:</p>
<ol type="1">
<li>What is the price and review score for the most expensive French wine?</li>
<li>How many countries have wine that cost more than $500?</li>
<li>To which country and province should you travel to find the cheapest Tempranillo?</li>
<li>You found a website that lets you order any wine for a flat shipping fee of $15! Find the total price for each wine that includes shipping.</li>
<li>The following code produces errors. Correct them all:</li>
</ol>
<p>reviews %&gt;%<br>
select == (Title, province, country, price) %&gt;%<br>
filter (country = Germany) %&gt;<br>
group_by (province) %&gt;%<br>
Summarise (mean_price == mean(price))</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>